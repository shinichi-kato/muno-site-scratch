---
title: "チャットボット関連研究のレビュー"
color: "secondary"
updated: "2022-08-16T12:00Z"
featuredImage: "ceiling.jpg"
tags: 
    - "review"
---
**本ページは現在推敲中です**

チャットボットは会話をする「ふり」をするプログラムです。  
「人間と会話ができる」というゴールは人工知能の研究が目指すゴールの一つでもあるのですが、今のところ実現は相当先と言われています。
また会話ができるためには人工知能的なアプローチの他に多くの要因があり、チャットボット研究ではそう言った部分にも注目しています。
その一方でチャットボットの実装に使われる技術の多くは人工知能研究の成果からもたらされています。
今回は人工知能研究とチャットボットの関係を振り返り、未来のチャットボットについて考えてみたいと思います。
 
人工知能研究にはこれまでに3つのブームがあったと言われています[^1]。

[^1]: [平成28年度 情報通信白書 人工知能（AI）の現状と未来](https://www.soumu.go.jp/johotsusintokei/whitepaper/ja/h28/pdf/n4200000.pdf)

## 第一次人工知能ブーム
最初は1950年代後半から1970年ごろまでの第一次人工知能ブームで、自然言語処理、ニューラルネットワーク、推論や探索といったパラダイムが発達し、このブームの中でElizaが作られました。
この時期には現在主流となっている統計的人工知能の基礎理論が既に発表されていました。
またさまざまな記号論的人工知能の技術も開発され、推論や演繹操作を行うメカニズムが提案されていました。
その後ユーザへの質問を繰り返して人工知能が持つ知識を元に正解を見つける「エキスパートシステム」が考案されました。
このシステムは医療診断などへの応用が期待されましたが、実際には現実の情報が複雑過ぎてうまくいかず、ブームは冬の時代に入りました。
エキスパートシステムはそのアルゴリズムを利用した[20Qというおもちゃのオンラインデモ](http://20q.net/)で雰囲気を知ることができます。
 
最初期の代表的なチャットボットである**Eliza**は1966年にジョセフ・ワイゼンバウムによって発表されました[^2]。

[^2]:[J. Weizenbaum,"ELIZA A Computer Program For the Study of Natural Language Communication Between Man And Machine", *Comp. Linguistics* 9[1](1996)](https://dl.acm.org/doi/pdf/10.1145/365153.365168)

ワイゼンバウムがこのチャットボットを「大まかにロジャー派のセラピストのように応答する」と述べているように、Elizaはユーザに質問し、ユーザ自身が自分の悩みに対する答えに気づくように導きました。


## 第二次人工知能ブーム
第二次人工知能ブームは1980年代から1990年代頃で、音声認識やデータマイニングなどの統計的人工知能の技術発達とともに、記号論的人工知能の分野では知識をデータとして表現する研究が行われました。
知識表現の一つの研究分野であるオントロジー工学では様々な概念の系統的な整理が試みられました。
しかしオントロジーを作ること自体が自動化できず、また大量の情報を集めることが困難であったためブームは終わりました。



ソフトウェアを利用したカウンセリングの研究は続いており[^4]、前述のワイゼンバウムが目指した来談者中心療法以外にも認知行動療法、系統的脱感作法、理性感情行動療法などを

[^4]: [H.Fujino, "Current situations and problems of software counselling" Proc. 2003 IEEE Intern. Sym. ](https://doi.org/10.1109/CIRA.2003.1222244)

### AIML
Artificial Intelligence Markup Language(AIML)はBruno Marietto[^3]らによって開発された、AIという名前がついていますがチャットボット記述用の言語です。

[^3]:[Bruno Marietto, et. al., "ARTIFICIAL INTELLIGENCE MARKUP LANGUAGE: A BRIEF TUTORIAL", *Intern. J. Computer Sci. and Eng. Survey* 4[3](2013)](https://arxiv.org/pdf/1307.3091.pdf)

AIMLやその派生言語を利用したチャットボットは数多く作られ、現在では[A.I.Nexus](https://knytetrypper.proboards.com/)でそれらを見ることができます。
この言語はElizaのスクリプトをベースにしており、第二次人工知能ブームとチャットボットとはあまり強く結びつかなかったようです。

### 日本語版のチャットボット

1990年代には日本でホビーとして様々なチャットボットが作られました。


## 第三次人工知能ブーム
2000年代後半頃から2022年現在も続く第三次人工知能ブームでは深層学習を始めとした統計的人工知能が注目されました。
またネットワークの急激な発達によって画像、動画、テキストなどのデータを大量に入手・計算処理することが可能になり、自動運転や生産管理など社会実装が明確な形で進みました。
自然言語処理においても統計的な手法が考案されるとテキストデータを深層学習で取り扱う道が開け、チャットボットの商業化が本格化しました。



# 記号論的人工知能と統計的人工知能

これまで見てきたように、人工知能には**記号的人工知能**と**統計的人工知能**という二種類の流れがあります。
最近は統計的人工知能の研究や社会実装が活発ですが、特に自然言語に限った

利点
* 記号操作が得意。推論やアブダクションが研究された
* 設計性
課題
* 可能性爆発
* 接地問題

## 統計的人工知能のアプローチ

一問一答形式のチャットボットでは、辞書の入力文字列を何らかの内部コードに写像し、その内部コードを出力文字列に変換するという動作をします。
入力文字列から内部コードへの変換の手法として最も基本的なのはBag-of-Wordsによるベクトル化で、最近は統計的機械学習もよく利用されています。

統計的機械学習による内部コード化のうち、典型的な例を一つ示します[^10]。 

[^10]:[Amila Viraj, "How To Build Your Own Chatbot Using Deep Learning”, medium (2020)](https://towardsdatascience.com/how-to-build-your-own-chatbot-using-deep-learning-bb41f970e281)

これは機械学習の基本的な用途の一つである「分類」で、辞書で与えた入力文字列を意図(intent)と呼ばれるコードのどれかに分類するという学習モデルを用意します。
得られたモデルにユーザからの入力を与えるとintentを予測します。intentが決まったら辞書を使って出力文字列を決めます。こうして一問一答形式のチャットボットを作ることができます。
ところがこの方法では会話の流れを一切無視した反応になってしまいます。そこで

チャットボットがより「生きている」と感じられるようにするため、ベイツは**感情**の組み込みが必要だと指摘しています[^11]。
ユーザのさまざまな入力文字列について喜怒哀楽のような感情を人間が読んでラベルを付与し、機械学習によってユーザ入力がどの感情に属する発言かを予測することができます。
それを利用し、Shinらはユーザの感情がポジティブならポジティブな反応を、ネガティブならネガティブな反応をするチャットボットを検討しました[^12]。
これが可能であれば共感的な反応は可能になると思われます。
しかし、ユーザの感情は会話の流れの中で形作られるもので、恋人にやさしく囁かれた「ばか」と、嫌いな上司から憎々しげに言われた「ばか」とは明らかに別物です。
また同じ上司のセリフであっても、揉めているときの「（お前に任せた）**俺が馬鹿だった**」と、誤解が溶けた後の「（話を聞いてやれなかった）**俺が馬鹿だった**」は意図が逆になります。
Shinらの例では感情をポジティブ-ネガティブという一つの次元で示しました。それ以外にもっと複雑な感情の分類がいくつも考えられており、例えばMageedらはユーザの入力から得られる感情をPlutchikの輪に従って24に分類することを試みました[^13]。
彼らはGated Recurrent Neural Networkと呼ばれる手法を用いて、文脈に沿って高い精度でユーザの感情を細かく推測することに成功しています。
この方法ではテキストレベルで辞書や会話ログを模倣するだけでなく、感情状態のレベルで会話ログを模倣することに近づくでしょう。
しかし私達は同じ文脈だからといって、常に同じ感情になるわけではありません。
「いい天気ですね」という返答が正解になるのはその日の天候によるのであって、会話ログをいくら集めても正解を知ることはできないでしょう。
さらに私達は意識的に表現する感情をコントロールし、平静を装ったり空元気を見せたりもします。本当の感情に自分自身が気がついていないこともあるでしょう。
そのため、特に雑談チャットボットではこれらの方針はうまく機能しないでしょう。

[^11]:[J. Bates, "The role of emotion in believable agents", *Commun. ACM* 37[7] pp.122-125(1994)](https://dl.acm.org/doi/pdf/10.1145/176789.176803)
[^12]:[J. Shin et. al., "Generating Empathetic Responses by Looking Ahead The User’s Sentiment" ICASSP 2020](https://arxiv.org/pdf/1906.08487.pdf)
[^13]:[M. A. Mageed et. al., "EmoNet: Fine-Grained Emotion Detection with Gated Recurrent Neural Networks", *Proc. 55th Annual Meeting of the Assoc. for Computational Ling. pp.718-728(2017)](https://aclanthology.org/P17-1067.pdf)



[^14]:[Rhio Sutoyo, et.al., "Designing an Emotionally Realistic Chatbot Framework to Enhance Its Believability with AIML and Information States", *4th Intern. Conf. Computer Sci. and Computational Interl. 2019* 12-13(2019)](https://reader.elsevier.com/reader/sd/pii/S1877050919311457?token=E7B52A16CF6120EB43F1687205F9C1F27D4034D96A6512901719818AA434D30FE7133E81569609C645B2D8A17E06A5B6&originRegion=us-east-1&originCreation=20220816073643)

### 深層学習

### 統計的機械学習の利点と課題

統計的機械学習のアプローチは、記号論的な手法があまり得意としなかった大量データの処理に道を開きました。
その一方でデータが多くなりすぎるとトピックや傾向の違う会話データが混在することが問題になり、それを統計的な工夫で分割する必要性が論じられました

利点
* 大量データ処理。計算量が大きい
* 
課題
* 論理を構成しづらい
* 文脈性をもたせにくい


## あすのチャットボット

動物の進化との共通点があるように思います。

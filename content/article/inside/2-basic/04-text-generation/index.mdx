---
title: 自動テキスト生成
color: "secondary"
updated: "2022-10-05T12:00Z"
featuredImage: tiles.jpg
tags: 
    - "テキスト生成"
    - "自然言語解析"
---

 **本ページは現在推敲中です**

チャットボットの会話では、チャットボットが同じような発言ばかりしたり、関係のない返事をしてしまうことが課題になっています。
誰かからこのような発言されたとき、聞き手の人間は話し手が強い不満を感じているのではないかと感じたり、話し手からバカにされたような気持ちにさせられてしまうためです。  
チャットボットを**エンコーダー**、**内的プロセス**、**デコーダー**に分けて考えたとき、関係のない返事をしてしまうのは**エンコーダー**でユーザの入力を適切に認識できていない、という課題とみなすことができます。
一方同じ発言の繰り返しは**内的プロセス**であればこれまでの会話を考慮できていない、**デコーダー**であれば返答生成用の辞書が小さすぎる、ということが課題だと言えます。

今回はこれらのうち**デコーダー**に着目し、その解決策を探ります。

返答生成用の辞書の返答を豊かなものにするには、巨大でかつ質の高い辞書が求められます。手動で辞書を改善すると、高い質の辞書を作ることができるものの巨大な辞書を作ることは大変苦痛を伴う作業であり、現実的とは言えません。
機械学習による自然言語処理が普及した現在ではこれを自動化する方法がいくつか提案されています。それらはマルコフ連鎖を使った方法と機械学習による方法に大別できます。

## 自動文生成の手法
### マルコフ連鎖
マルコフ連鎖とはテキストを文字や形態素といったノードに分割しておき、「次にくるノードはなにか」を確率過程として表現したものです。
チャットやSNSのログ、小説などを元にしてマルコフ連鎖辞書を生成すると、元のテキストで使われる単語を使って文らしきものを生成することができます。
web上でマルコフ連鎖によるテキスト生成を試せるサイトやマルコフ連鎖のためのpythonモジュールもあります。

* [PHP Markov chain text generator](https://projects.haykranen.nl/markov/demo/)
* [markovify](https://github.com/jsvine/markovify)

### 機械学習によるテキスト生成

深層学習を用いたテキスト生成では、マルコフ連鎖よりも自然なテキストが得られるようになってきました。
これは機械学習により「次に出現する単語を予測する」という課題として

* [RNN によるテキスト生成](https://www.tensorflow.org/tutorials/text/text_generation?hl=ja)

## チャットボットで用いる手法

最近は機械学習や深層学習を使う方法が注目されており、チャットボットりんななどでも利用されています。
この方法は大量のテキストを扱うことに適していますが、大量になると不特定多数の個人が様々な状況で発言したデータの寄せ集めになり、一つの個性を表現するのは困難になっていきます。
大量のテキストにはチャットボット製作者が考慮しきれないような不適切発言が混入しており、学習モデルではそれを観察することが困難なので、それを除去することが課題になります。
また機械学習の特性として学習にも会話にも巨大な計算資源が必要になるので、サーバー側でチャットボットが動かせる環境が必要になります。  

マルコフ連鎖でも辞書のもととなるテキストが大量になることによる課題は共通していますが、マルコフ連鎖辞書は機械学習の辞書と比べてまだ可読性があります。
また機械学習と比べて小さいテキストであっても辞書が生成でき、かつ発話時似必要な計算資源は非常に少ないというメリットがあります。
そこで、以降の章ではマルコフ連鎖を使ったテキスト生成について詳しく議論していきます。